# Import Linter Configuration for Clean Architecture
# Enforces layer boundaries to prevent architectural violations
#
# Layer Structure:
# 1. Presentation: src/dashboard/blueprints/, templates/, static/
# 2. Application: src/dashboard/services/
# 3. Domain: src/models/
# 4. Infrastructure: src/collectors/, src/utils/, src/config.py
#
# Dependency Rule: Presentation → Application → Domain
#                                   ↓
#                            Infrastructure → Domain (models only)

[importlinter]
root_package = src
include_external_packages = False

[importlinter:contract:1]
name = Domain layer must not import from other layers
type = forbidden
source_modules =
    src.models
forbidden_modules =
    src.dashboard
    src.collectors
    src.utils
    src.config
# No ignores - Domain layer is now pure! (Phase 3.1 complete)

[importlinter:contract:2]
name = Presentation layer must not import Domain directly
type = forbidden
source_modules =
    src.dashboard.blueprints
forbidden_modules =
    src.models
ignore_imports =
    # Transitive dependency through Application layer (correct architecture)
    # Blueprint → TrendsService (Application) → PerformanceScorer (Domain)
    # This is the correct flow: Presentation → Application → Domain
    src.dashboard.blueprints.dashboard -> src.dashboard.services.trends_service

[importlinter:contract:3]
name = Presentation layer must not import Infrastructure
type = forbidden
source_modules =
    src.dashboard.blueprints
    src.dashboard.utils
forbidden_modules =
    src.collectors
    src.utils
ignore_imports =
    # Performance monitoring - Adapter pattern (Phase 4.1)
    # dashboard.utils.performance_decorator wraps Infrastructure's timed_route
    # This keeps blueprints from directly importing Infrastructure
    # Only the adapter module (performance_decorator) has Infrastructure dependency
    src.dashboard.utils.performance_decorator -> src.utils.performance

[importlinter:contract:4]
name = Infrastructure must not import Presentation
type = forbidden
source_modules =
    src.collectors
    src.utils
forbidden_modules =
    src.dashboard.blueprints
    src.dashboard.templates
# No ignores - performance utilities moved to Infrastructure (Phase 3.3 complete)

[importlinter:contract:5]
name = Infrastructure must not import Application services
type = forbidden
source_modules =
    src.collectors
    src.utils
forbidden_modules =
    src.dashboard.services

[importlinter:contract:6]
name = Application layer must not import Presentation
type = forbidden
source_modules =
    src.dashboard.services
forbidden_modules =
    src.dashboard.blueprints
