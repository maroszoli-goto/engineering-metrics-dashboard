github:
  token: "your_github_personal_access_token_here"

  # Option 1: Track specific repositories
  repositories:
    - owner: "your-org"
      repo: "your-repo"
    - owner: "your-org"
      repo: "another-repo"

  # Option 2: Track all repos in an organization (comment out repositories above if using this)
  # organization: "your-org-name"

  # Filter metrics to specific team members (optional)
  # If set, only PRs, commits, and reviews from these users will be included
  team_member_usernames:
    - "github-username1"
    - "github-username2"

  # Date range for metrics collection
  days_back: 90

jira:
  # Multi-Environment Support
  # ------------------------
  # NEW: You can configure multiple Jira environments (prod, uat, staging, etc.)
  # Each environment has separate credentials, filter IDs, and time offsets.
  #
  # IMPORTANT: time_offset_days applies to BOTH GitHub and Jira collectors
  # to ensure data alignment for DORA metrics calculation.
  #
  # LEGACY FORMAT (single environment):
  # If you don't need multi-environment support, use flat config:
  #   server: "https://jira.yourcompany.com"
  #   username: "username"
  #   api_token: "token"
  #   project_keys: ["PROJ"]
  #
  # NEW FORMAT (multi-environment):
  default_environment: "prod"  # Used when --env flag not specified

  environments:
    prod:
      server: "https://jira.yourcompany.com"
      username: "your-username"  # NOT email for self-hosted Jira
      api_token: "your_bearer_token"
      project_keys:
        - "PROJ"
        - "TEAM"
      time_offset_days: 0  # Production is current (no offset)
                          # NOTE: Applies to BOTH GitHub and Jira collectors

      # Pagination settings for large datasets
      pagination:
        enabled: true
        batch_size: 500
        huge_dataset_threshold: 5000
        fetch_changelog_for_large: false
        max_retries: 3
        retry_delay_seconds: 5

    uat:
      server: "https://jira-uat.yourcompany.com"
      username: "your-username"
      api_token: "uat_bearer_token"
      project_keys:
        - "PROJ"
        - "TEAM"
      time_offset_days: 180  # UAT is 6 months (180 days) behind prod
                            # NOTE: Applies to BOTH GitHub and Jira collectors
                            # GitHub: Queries current API, filters by dates from 180 days ago
                            # Jira: Queries UAT database (snapshot from 180 days ago)

      pagination:
        enabled: true
        batch_size: 500
        huge_dataset_threshold: 0  # Disable changelog for UAT (faster, fewer timeouts)
        fetch_changelog_for_large: false
        max_retries: 5
        retry_delay_seconds: 5

# Team configurations
#
# Member Format Options:
# ----------------------
# Option 1 (Simple format): List of username strings
#   - Just GitHub usernames as strings
#   - Members are matched by index with Jira members
#   - Shown below for Team Alpha
#
# Option 2 (NEW - With display names): List of dicts with username and name
#   - Supports displaying full names instead of usernames in UI
#   - Format: - username: "github-username"
#             name: "Full Name"
#   - Example shown in comments below
#
# Option 3 (Explicit mapping): Member dicts with github/jira keys
#   - More explicit, safer when GitHub and Jira usernames differ
#   - Enables per-person Jira metrics on person dashboard
#
# NEW DISPLAY NAME FORMAT (uncomment to use):
# github:
#   members:
#     - username: "jsmith"
#       name: "John Smith"
#     - username: "alee"
#       name: "Alice Lee"
#
teams:
  - name: "Backend"
    display_name: "Backend Team"
    members:
        - name: "John Smith"
          github: "jsmith"
          jira: "john.smith"
        - name: "Alice Lee"
          github: "alee"
          jira: "alice.lee"
        - name: "Bob Chen"
          github: "bchen"
          jira: "bob.chen"
        - name: "Maria Garcia"
          github: "mgarcia"
          jira: "maria.garcia"
        - name: "David Kim"
          github: "dkim"
          jira: "david.kim"
    github:
      team_slug: "backend-team"
    jira:
      # Filter IDs - run list_jira_filters.py to discover these
      # IMPORTANT: Filters should NOT contain ORDER BY or hardcoded time constraints
      # - Remove: created >= -12w, resolved >= -12w, resolutiondate >= -12w
      # - Let Python code handle date filtering dynamically based on --date-range
      #
      # NEW: Environment-specific filter IDs
      # Each environment (prod, uat) needs separate filter IDs
      filters:
        prod:
          bugs: 12345
          bugs_created: 12346
          bugs_resolved: 12347
          completed: 12348
          flagged_blocked: 12349
          scope: 12350
          wip: 12351
          incidents: 12352  # Production incidents for DORA CFR/MTTR
        uat:
          bugs: 22345
          bugs_created: 22346
          bugs_resolved: 22347
          completed: 22348
          flagged_blocked: 22349
          scope: 22350
          wip: 22351
          incidents: 22352
      #
      # LEGACY FORMAT (single environment):
      # If not using multi-environment, use flat filter IDs:
      #   bugs: 12345
      #   bugs_created: 12346
      #   ...etc

  - name: "Frontend"
    display_name: "Frontend Team"
    # New format: Explicit GitHub/Jira mapping (recommended)
    members:
      - name: "Sarah Johnson"
        github: "sjohnson"
        jira: "sarah.johnson"
      - name: "Tom Wilson"
        github: "twilson"
        jira: "tom.wilson"
      - name: "Emma Davis"
        github: "edavis"
        jira: "emma.davis"
      - name: "Michael Brown"
        github: "mbrown"
        jira: "michael.brown"
      - name: "Lisa Martinez"
        github: "lmartinez"
        jira: "lisa.martinez"
    github:
      team_slug: "frontend-team"
    jira:
      # Filter IDs - run list_jira_filters.py to discover these
      filters:
        prod:
          bugs: 13345
          bugs_created: 13346
          bugs_resolved: 13347
          completed: 13348
          flagged_blocked: 13349
          scope: 13350
          wip: 13351
          incidents: 13352  # Production incidents for DORA CFR/MTTR metrics
        uat:
          bugs: 23345
          bugs_created: 23346
          bugs_resolved: 23347
          completed: 23348
          flagged_blocked: 23349
          scope: 23350
          wip: 23351
          incidents: 23352

# Time period configurations
time_periods:
  last_n_days: [7, 14, 30, 60, 90]
  quarters_enabled: true
  custom_range_enabled: true
  max_days_back: 365

# Activity threshold configurations
activity_thresholds:
  minimum_values:
    prs_per_month: 5
    reviews_per_month: 10
    commits_per_month: 20
  trend_decline_threshold_percent: 20  # Flag if declined >20%
  below_average_threshold_percent: 70  # Flag if <70% of team average

# DORA Metrics configurations
dora_metrics:
  max_lead_time_days: 180  # Filter out lead times > 180 days (likely data errors)
  cfr_correlation_window_hours: 24  # Hours after deployment to correlate incidents

# Dashboard settings
dashboard:
  port: 5001
  debug: true
  cache_duration_minutes: 60  # How long to cache metrics before auto-refresh
  jira_timeout_seconds: 120   # Timeout for Jira API requests

  # Enhanced Cache Configuration (optional)
  # Two-tier caching (memory + disk) for faster response times
  cache:
    max_memory_mb: 500          # Maximum memory cache size in MB (default: 500)
    enable_memory_cache: true   # Enable in-memory caching layer (default: true)
    warm_on_startup: true       # Pre-load common ranges on startup (default: true)
    warm_keys:                  # Keys to pre-load (default: 90d, 30d, 180d for prod)
      - "90d_prod"
      - "30d_prod"
      - "180d_prod"

  # Authentication (optional, disabled by default)
  # Secures dashboard with HTTP Basic Auth
  # Generate password hashes: python scripts/generate_password_hash.py
  auth:
    enabled: false  # Set to true to enable authentication
    users:
      # - username: admin
      #   password_hash: pbkdf2:sha256:600000$...  # Generate with scripts/generate_password_hash.py
      # - username: viewer
      #   password_hash: pbkdf2:sha256:600000$...

# Parallel Data Collection (optional)
# Speeds up data collection by running teams, persons, repos, and filters concurrently.
# This reduces collection time from ~18 hours to ~4 hours for 12 date ranges (4-5x speedup).
#
# Defaults (if not specified):
#   enabled: true
#   person_workers: 8
#   team_workers: 3
#   repo_workers: 5
#   filter_workers: 4
#
# Set enabled: false to use sequential collection if issues arise.
#
# parallel_collection:
#   enabled: true           # Master switch for parallel collection
#   person_workers: 8       # Number of persons to collect in parallel
#   team_workers: 3         # Number of teams to collect in parallel
#   repo_workers: 5         # Number of repos per team to collect in parallel
#   filter_workers: 4       # Number of Jira filters per team to collect in parallel

# Performance Score Weights (optional)
# These weights determine how different metrics contribute to performance scores
# in team and member comparisons. All weights must sum to 1.0 (100%).
#
# If not specified, system uses these defaults:
#   GitHub metrics (55%): PRs, Reviews, Commits, Cycle Time, Merge Rate
#   DORA metrics (30%): Deployment Frequency, Lead Time, CFR, MTTR
#   Jira metrics (15%): Jira Completed
#
# You can customize these via the Settings page in the dashboard
# (http://localhost:5001/settings) without editing this file.
#
# performance_weights:
#   # GitHub metrics
#   prs: 0.15                    # Pull requests created (higher is better)
#   reviews: 0.15                # Code reviews given (higher is better)
#   commits: 0.10                # Commits made (higher is better)
#   cycle_time: 0.10             # PR cycle time (lower is better)
#   merge_rate: 0.05             # PR merge success rate (higher is better)
#   jira_completed: 0.15         # Jira issues completed (higher is better)
#   # DORA metrics (requires releases and incident tracking)
#   deployment_frequency: 0.10   # Deployments per week (higher is better)
#   lead_time: 0.10              # Lead time for changes (lower is better)
#   change_failure_rate: 0.05    # % deployments causing incidents (lower is better)
#   mttr: 0.05                   # Mean time to recover from incidents (lower is better)
